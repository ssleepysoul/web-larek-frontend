# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


[//]: # (Используемый стек.)

[//]: # (Описание базовых классов, их предназначение и функции.)

## Архитектура проекта

### Общий подход: 
Приложение реализовано с помощью паттерна MVP. Приложение представляет собой набор View и общие классы Презентера и Модели. Взаимодействие между блоками осуществляется при помощи шины/брокера событий. Класс Модели хранит в себе те данные, которые нужны всем блокам приложения.

<!-- **Блоки** - представляют собой логически законченную функциональность. Реализованы с помощью паттерна MVP. Блок 
взаимодействует с другим блоком через события. У каждого блока есть: модель данных, набор представлений, отвечающих 
за отрисовку шаблонов и презентер - связующее звено, реализующее основную логику блока.

GlobalState хранит в себе те данные, которые нужны всем блокам приложения. Для текущего приложения это Products 
(список товаров), он нужен как для отрисовки списка товаров, так и для списка товаров в корзине.

EventBus - глобальная шина событий отвечающая за коммуникацию между блоками.  -->

### Описание реализации

### Глобальные части системы:

#### класс Модели(AppModel)
Создается при инициализации приложения. Отвечает за хранение и обмен данными.
Поля:
- cardById: ProductApiModel - хранение карточки по ее id;
- basketItems: ProductApiModel[] - хранение товаров корзины;
- orderData: OrderApiRequestModel - вся информация по заказу;
- orderResponse: OrderApiResponseSuccessModel | OrderApiResponseErrorModel - хранение ответа сервера о размещении заказа;

Методы:
- getCards():void - получение всех карточек товаров
- getCardById(cardId: string):void - получение карточки по ее id
- postOrder(orderData: OrderApiRequestModel):void - отправка заказа на сервер


#### EventEmitter
Класс шины событий. Создается при инициализации приложения.

События:
- getCardsEventName - получение всех карточек товаров при инициализации;
- getCardByIdEventName - получение карточки по id для отображения в модальном окне;
- getBasketEventName - делает кнопку добавления товара в корзину не активной;
- updateBasketItemsEventName - обновляет массив товаров в корзине;
- payCashEventName - выбор наличной оплаты;
- payCardEventName - выбор оплаты картой;
- getOrderResponseEventName - получение ответа от сервера при отправке заказа;
- openCardElementEventName - открытие карточки товара;
- clickOnSuccessButtonEventName - обработка клика к новым покупкам;
- clickOnPayButtonEventName - обработка клика оплатить;
- clickOnOrderButtonEventName - валидация поля адрес и открытие модалки личных данных
- clickOnBasketButtonEventName - обработка клика оформить;
- clickOnBasketEventName - обработка клика по корзине;
- clickOnAddToBasketButtonEventName - обработка клика добавления товара в корзину;


#### класс Презентера(AppPresenter)
Создается при инициализации приложения. Класс осуществляющий взаимодействие между моделью и классами представления(View) при помощи EventEmitter

Поля создаются для каждого класса представления, модели и EventEmitter. Методов в классе нет. Все происходит с помощью EventEmitter.

____________________________________________________________________________________________________________________

#### класс CardView
Поля:
- template - сам темплэйт для создания карточки;
- cardListElement - список куда будут вставляться все карточки;
- eventEmitter: EventEmitter;

Методы:
- render(card: ProductApiModel) - принимает аргументом модель карточки и возвращает cardElement


#### класс CardPreviewView
Поля:
- template - сам темплэйт для создания открытой карточки;
- eventEmitter: EventEmitter;

Методы:
- createElement(card: ProductApiModel, isItemInBasket: boolean): HTMLElement - принимает аргументом модель карточки и проверяет есть ли данная карточка в корзине, возвращает cardElement;
- setDisabled(button: HTMLElement) - принимает аргументом кнопку и делает ее неактивной;

#### класс BasketView
Поля: 
- templateBasket - сам тэмплэйт корзины;
- basketList - список товаров;
- basketItemIndex - индекс товара в списке;
- cardTitle - наименование товара;
- cardPrice - стоимость товара;
- basketPrice - общая стоимость товаров;
- counterPrice - вспомогательное поле для подсчета стоимости корзины;
- basketItemDelete - кнопка удаления товара из корзины;
- eventEmitter: EventEmitter;
- basketCounter - индекс отображения количества товаров на иконке корзины;

Методы:
- render(basketItems: BasketItemModel []) - метод принимает аргументом массив товаров и отрисовывает их в корзине;
- clear(basketItems: BasketItemModel []) - метод прнимает аргументом массив товаров и очищает этот массив;
- basketCounterUpdate(count: number) - метод принимает аргументом число и меняет отображение числа каунтера;
- updateBasketItemIndexes - метод перенумеровывает индексы товаров после удаления одного из товаров;


#### класс ContactsView
Поля: 
- contactsTemplate - сам тэмплэйт отображения данных;
- eventEmitter - EventEmitter;
- payButton - кнопка оплатить, переход к следующему модальному окну, отправка заказа на сервер;
- payFormError - отображение ошибки валидации инпутов;
- payFormInputEmail - инпут эмэйла;
- payFormInputPhone - инпут телефона;

В классе нет методов, элементы находятся в конструкторе, там же висит обработчик клика кнопки оплатить с событием



#### класс ModalView
Поля: 
- modal - сам тэмплэйт модального окна;
- modalContentContainer - контейнер в модальном окне, чей контент будет меняться;
- page - сама страница;
- closeButton - кнопка по которой будет закрываться модальное окно;
- modalContent - вспомогательный элемент для отрисовки и очистки модального окна;

Методы:
- render(modalContentElement: HTMLElement) - принимает на вход готовый хтмл-элемент для отрисовки внутри модального окна;
- open(modalContentElement: HTMLElement) - принимает на вход готовый хтмл-элемент и вызывает метод рендер, открывает модальное окно;
- close() - закрывает модальное окно;


#### класс OrderView
Поля:
- orderTemplate - тэмплэйт формы заказа;
- eventEmitter - EventEmitter;
- orderButton - кнопка заказа, которая закрывает текущее модальное окно и открывает модальное окно контактных данных;
- orderFormError - ошибка валидации инпута;
- orderFormInput - инпут адреса;

Методов в классе нет. В конструкторе находим кнопки оплаты и вешаем на них обработчики клика с событиями. Также вешаем обработчик клика с событием на orderButton.

#### класс SuccessView
Поля: 
- successTemplate - тэмплэйт успешного заказа;
- successDescription - описание со стоимостью заказа, который приходит в ответ на размещение заказа на сервере;
- successButton - кнопка закрывает модальное окно;
- eventEmitter - EventEmitter;

Методов в классе нет. Обработчик клика с событием на orderButton вешается в консрукторе.
